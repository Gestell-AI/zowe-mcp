000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. INITVSAM.
000300 AUTHOR. VSAM INITIALIZATION PROGRAM.
000400*
000500* PURPOSE: INITIALIZE EMPTY VSAM DATASETS TO SET HI-USED-RBA
000600* ENTERPRISE COBOL AUTOMATICALLY WRITES AND DELETES DUMMY RECORD
000700* WHEN OPENING VSAM FILES FOR OUTPUT - NO MANUAL LOGIC NEEDED
000800*
000900 ENVIRONMENT DIVISION.
001000 INPUT-OUTPUT SECTION.
001100 FILE-CONTROL.
001200     SELECT ACCOUNT-FILE ASSIGN TO ACCDATA
001300         ORGANIZATION IS INDEXED
001400         ACCESS MODE IS DYNAMIC
001500         RECORD KEY IS CUST-KEY
001600         FILE STATUS IS WS-ACCT-STATUS.
001700     SELECT TXN-FILE ASSIGN TO TXNDATA
001800         ORGANIZATION IS INDEXED
001900         ACCESS MODE IS DYNAMIC
002000         RECORD KEY IS TXN-ID
002100         FILE STATUS IS WS-TXN-STATUS.
002200
002300 DATA DIVISION.
002400 FILE SECTION.
002500 FD  ACCOUNT-FILE
002600     RECORD CONTAINS 200 CHARACTERS.
002700 COPY CUSTCOPY.
002800
002900 FD  TXN-FILE
003000     RECORD CONTAINS 200 CHARACTERS.
003100 COPY TXNCOPY.
004600
004700 WORKING-STORAGE SECTION.
004800 01  WS-FILE-STATUS.
004900     05  WS-ACCT-STATUS          PIC XX.
005000     05  WS-TXN-STATUS           PIC XX.
005100
005200 PROCEDURE DIVISION.
005300 MAIN-PROCESS.
005400     DISPLAY 'INITVSAM: INITIALIZING VSAM DATASETS'
005500     PERFORM INIT-ACCOUNT-FILE
005600     PERFORM INIT-TXN-FILE
005700     DISPLAY 'INITVSAM: INITIALIZATION COMPLETE'
005800     GOBACK.
005900
006000 INIT-ACCOUNT-FILE.
006100     DISPLAY 'INITIALIZING ACCOUNTS CLUSTER'
006200     OPEN OUTPUT ACCOUNT-FILE
006300     IF WS-ACCT-STATUS NOT = '00'
006400         DISPLAY 'ERROR OPENING ACCOUNT FILE: ' WS-ACCT-STATUS
006500         GOBACK
006600     ELSE
006700         DISPLAY 'ACCOUNT CLUSTER INITIALIZED SUCCESSFULLY'
006800     END-IF
006900     CLOSE ACCOUNT-FILE.
007000
007100 INIT-TXN-FILE.
007200     DISPLAY 'INITIALIZING TRANSACTION CLUSTER'
007300     OPEN OUTPUT TXN-FILE
007400     IF WS-TXN-STATUS NOT = '00'
007500         DISPLAY 'ERROR OPENING TXN FILE: ' WS-TXN-STATUS
007600         GOBACK
007700     ELSE
007800         DISPLAY 'TRANSACTION CLUSTER INITIALIZED SUCCESSFULLY'
007900     END-IF
008000     CLOSE TXN-FILE.